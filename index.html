<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Buscar Unidad Funcional</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; }
        form { margin-bottom: 1em; }
        label { display: block; margin-top: 1em; }
        input[type="text"], input[type="number"] { width: 120px; }
        #resultado { margin-top: 1em; font-weight: bold; }
        textarea { width: 100%; height: 120px; margin-top: 1em; }
    </style>
</head>
<body>
    <h1>Buscar Unidad Funcional o Departamento</h1>
    <form id="form-uf">
        <label>
            Ingrese Departamento (ej: 1A, 15C, 20T) <b>o</b> Unidad Funcional (ej: 4, 120, 400):
            <input type="text" id="departamento" required maxlength="5" pattern="^\d{1,2}[A-Za-z]$|^\d{1,4}$">
        </label>
        <button type="submit">Buscar</button>
    </form>
    <div id="resultado"></div>

    <h2>Configurar lista de Unidades Funcionales</h2>
    <p>Ingrese la lista en formato: <code>departamento,uf</code> (uno por línea, ejemplo: <code>1A,1</code>)</p>
    <textarea id="uf-lista" placeholder="1A,1&#10;1B,2&#10;..."></textarea>
    <button id="actualizar-lista">Actualizar lista</button>

    <script>
        // Array que puede ser informado manualmente
        let unidadesFuncionales = [];

        // Función para cargar la lista desde el textarea
        function cargarListaDesdeTextarea() {
            const texto = document.getElementById('uf-lista').value;
            const lineas = texto.split('\n');
            unidadesFuncionales = [];
            for (const linea of lineas) {
                const partes = linea.split(',');
                if (partes.length === 2) {
                    const departamento = partes[0].trim().toUpperCase();
                    const uf = parseInt(partes[1].trim(), 10);
                    if (departamento && !isNaN(uf)) {
                        unidadesFuncionales.push({ departamento, uf });
                    }
                }
            }
        }

        // Evento para actualizar la lista manualmente
        document.getElementById('actualizar-lista').addEventListener('click', function() {
            cargarListaDesdeTextarea();
            document.getElementById('resultado').textContent = 'Lista actualizada correctamente.';
        });

        // Buscar unidad funcional o departamento
        document.getElementById('form-uf').addEventListener('submit', function(e) {
            e.preventDefault();
            const input = document.getElementById('departamento').value.trim().toUpperCase();

            // Buscar como departamento
            let resultado = unidadesFuncionales.find(
                uf => uf.departamento === input
            );

            const divResultado = document.getElementById('resultado');
            if (resultado) {
                divResultado.textContent = `La unidad funcional asociada es: ${resultado.uf}`;
            } else {
                // Buscar como unidad funcional (número)
                const ufNum = parseInt(input, 10);
                if (!isNaN(ufNum)) {
                    resultado = unidadesFuncionales.find(
                        uf => uf.uf === ufNum
                    );
                    if (resultado) {
                        divResultado.textContent = `El departamento asociado es: ${resultado.departamento}`;
                    } else {
                        divResultado.textContent = 'No se encontró una unidad funcional ni un departamento asociado a ese valor.';
                    }
                } else {
                    divResultado.textContent = 'No se encontró una unidad funcional ni un departamento asociado a ese valor.';
                }
            }
        });

        // Secuencia de letras a usar
        const letras  = ['B','A','T','S','C','H','N','R','J','L','D','Q','G','I','K','M','E','P','F','O'];
        const letras8 = ['B','A','T','S','C','N','R','J','L','D','Q','I','K','M','E','P','F','O'];

        // Generar lista automáticamente desde UF 4
        let lista = '';
        let uf = 4;
        for (let piso = 1; piso <= 7; piso++) {
            for (let i = 0; i < letras.length; i++) {
                lista += `${piso}${letras[i]},${uf++}\n`;
            }
        }
        for (let i = 0; i < letras8.length; i++) {
            lista += `8${letras8[i]},${uf++}\n`;
        }
        for (let piso = 9; piso <= 20; piso++) {
            for (let i = 0; i < letras.length; i++) {
                lista += `${piso}${letras[i]},${uf++}\n`;
            }
        }
        // Eliminar salto de línea final si existe
        lista = lista.trim();

        document.getElementById('uf-lista').value = lista;
        cargarListaDesdeTextarea();
    </script>
</body>
</html>
